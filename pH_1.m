
function pH = pH_1(ALK,DIC,T,S)

%% calculate kw, k1, k2
T=T+273;

e = [148.9802,-13847.26,-23.6521];
eulers = 2.71828;

lnK = e(1) + (e(2)/T) + (e(3)*log(T));
K = eulers^lnK; 
Kw = K;

pk01 = (-126.34048) + ((6320.813)/T) + ((19.568224)*(log(T)));
pk02 = (-90.183330) + ((5143.692)/T) + ((14.613358)*(log(T)));

ek1 = [5.592953,0.028845,-6.388*(10^-5),-225.7489,-4.761,-0.8715109];
ek2 = [13.396949,0.12193009,-3.8362*(10^-4),-472.8633,-19.03634,-2.1563270];

e = ek1;
pK1 = pk01 + ((e(1))*(S^(0.5))) + ((e(2))*(S^(1))) + ((e(3))*(S^(2))) + (((e(4))*(S^(0.5)))/T) + (((e(5))*(S^(1)))/T) + ((e(6))*(S^(0.5))*(log(T))); 
K1 = 10^-pK1;

e = ek2;
pK2 = pk02 + ((e(1))*(S^(0.5))) + ((e(2))*(S^(1))) + ((e(3))*(S^(2))) + (((e(4))*(S^(0.5)))/T) + (((e(5))*(S^(1)))/T) + ((e(6))*(S^(0.5))*(log(T))); 
K2 = 10^-pK2;


%% convert inputs from umol L-1 to mol L-1

DIC = DIC*(10^-6);
ALK = ALK*(10^-6);

  p4 = 1;
  p3 = K1+ALK;
  p2 = K1*K2+ALK*K1-Kw-K1*DIC;
  p1 = ALK*K1*K2-Kw*K1-2*K1*K2*DIC;
  p0 = -Kw*K1*K2;
  p = [p4 p3 p2 p1 p0];
  r = roots(p);
  h = max(real(r));

pH    = -log10(h);
h2co3 = ((((1 + (K1/h) + ((K1*K2)/(h*h))))^-1)*DIC)*(10^6);
co3 = (DIC / (1 + h / K2 + h * h / K1 / K2))*(10^6);

